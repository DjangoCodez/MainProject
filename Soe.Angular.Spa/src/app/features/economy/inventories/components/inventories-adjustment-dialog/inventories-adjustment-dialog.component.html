<soe-dialog>
  <ng-container dialog-content>
    @if (form) {
      <form
        [formGroup]="form"
        class="soe-edit-form"
        novalidate
        autocomplete="off">
        <div class="row">
          <div class="col-sm-12">
            <div class="col-sm-12 mt-3">
              <soe-instruction [text]="dialogLabel"></soe-instruction>
            </div>
          </div>
        </div>
        <div class="row">
          <div class="col-sm-12">
            <div class="col-sm-3">
              <soe-numberbox
                [labelKey]="'common.amount'"
                [decimals]="numberOfDecimals"
                formControlName="amount"
                (valueChanged)="amountChanged($event)"></soe-numberbox>
            </div>
            <div class="col-sm-3">
              <soe-datepicker
                [labelKey]="'economy.inventory.inventories.adjustmentdate'"
                formControlName="adjustmentDate"></soe-datepicker>
            </div>
            <div class="col-sm-6">
              <soe-textbox
                [labelKey]="'common.note'"
                formControlName="noteText">
              </soe-textbox>
            </div>
          </div>
        </div>
        @if (isDispose()) {
          <div class="row">
            <div class="col-sm-12">
              <div class="col-sm-3">
                <soe-select
                  [labelKey]="
                    'economy.inventory.inventorywriteofftemplate.voucherserie'
                  "
                  [items]="voucherSeriesTypes || []"
                  [optionIdField]="'voucherSeriesTypeId'"
                  [optionNameField]="'name'"
                  formControlName="voucherSeriesTypeId">
                </soe-select>
              </div>
            </div>
          </div>
        }
        <div class="row">
          <div class="col-sm-12 p-3">
            <soe-accounting-rows
              [rowsIn]="accountingRows()"
              [container]="1"
              [showRegenerateButton]="true"
              [showTextValue]="true"
              [showBalance]="false"
              [showQuantity]="true"
              [showAmountSummary]="true"
              [currencyService]="currencyService"
              [numberOfDecimals]="numberOfDecimals"
              (regenerateCoding)="createAccountingRows()"
              (hasDebitCreditBalanceError)="hasDebitCreditBalanceError($event)"
              (accountingRowsChanged)="accountingRowsChanged($event)">
            </soe-accounting-rows>
          </div>
        </div>
        
        <div class="row">
            <div class="col-sm-12 p-3">
                <soe-expansion-panel [open]="false" [labelKey]="'common.changehistory'"
                    (isOpened)="isTrackChangesAccordionOpen = !isTrackChangesAccordionOpen">
                    @if (isTrackChangesAccordionOpen) {
                    <soe-track-changes [entityType]="9" [entityId]="form.inventoryId.value"></soe-track-changes>
                    }
                </soe-expansion-panel>
            </div>
        </div>

        <div class="soe-form-footer">
          <div class="col-sm-12">
            <div class="float-end">
              <soe-save-button
                class="ms-3"
                [invalid]="form.invalid"
                (action)="save()"
                (validationErrorsAction)="form.openFormValidationErrors()"
                [dirty]="form.dirty"></soe-save-button>

              <soe-button
                class="ms-3"
                [caption]="'core.cancel'"
                [behaviour]="'standard'"
                (action)="cancel()"></soe-button>
            </div>
          </div>
        </div>
      </form>
    }
  </ng-container>
</soe-dialog>
