<div class="messagebox">
    <div class="modal-header">
        <button type="button" class="close" data-ng-click="ctrl.buttonCancelClick()">&times;</button>
        <h6 class="modal-title">{{::ctrl.title}}</h6>
    </div>
    <div class="modal-body">
        <div class="form-group form-group-sm">
            <div class="row">
                <div class="col-sm-12">
                    <div class="info" style="padding: 10px;">
                        <div data-ng-bind-html="::ctrl.text"></div>
                    </div>
                </div>
            </div>
            <br />
            <div class="row" data-ng-if="ctrl.periodAccountDistributions.length > 1">
                <div class="col-sm-12">
                    <soe-select label-key="economy.accounting.accountdistribution.accountdistribution" model="ctrl.distributionHead" items="ctrl.periodAccountDistributions" options="item as item.name for item in items" on-changing="ctrl.accDistChanged(item)"></soe-select>
                </div>
            </div>
            <div class="row" data-ng-if="ctrl.newDistribution">
                <div class="col-sm-8">
                    <soe-textbox label-key="common.name" model="ctrl.templateName" auto-focus=""></soe-textbox>
                </div>
                <div class="col-sm-4">
                    <soe-select label-key="economy.accounting.accountdistribution.voucherserie" model="ctrl.distributionHead.voucherSeriesTypeId" required="ctrl.newDistribution" items="ctrl.voucherSeriesTypeFilterOptions" options="item.voucherSeriesTypeId as item.voucherSeriesTypeName for item in items"></soe-select>
                </div>
            </div>
            <div class="row" data-ng-if="ctrl.newDistribution">
                <div class="col-sm-3">
                    <soe-datepicker label-key="economy.accounting.accountdistribution.startdate" model="ctrl.startDate"></soe-datepicker>
                </div>
                <div class="col-sm-3">
                    <soe-datepicker label-key="economy.accounting.accountdistribution.enddate" model="ctrl.endDate" ng-if="ctrl.newDistribution" on-change="ctrl.setNbrOfPeriods()"></soe-datepicker>
                </div>
            </div>
            <div class="row" data-ng-if="ctrl.newDistribution">
                <div class="col-sm-3">
                    <soe-textbox label-key="economy.accounting.accountdistribution.numberOfPeriods" input-type="number" model="ctrl.nbrOfPeriods" auto-focus="" on-change="ctrl.setEndDate()"></soe-textbox>
                </div>
                <div class="col-sm-3">
                    <soe-select label-key="economy.accounting.accountdistribution.calculationtype" model="ctrl.calculationType" required="ctrl.newDistribution" ng-if="ctrl.newDistribution" on-changing="ctrl.calculateRowAmounts()" items="ctrl.accountDistributionCalculationType" options="item.id as item.name for item in items"></soe-select>
                </div>
            </div>
            <div class="row" data-ng-if="!ctrl.newDistribution">
                <div class="col-sm-3">
                    <soe-textbox label-key="economy.accounting.accountdistribution.numberOfPeriods" input-type="number" model="ctrl.nbrOfPeriods" auto-focus="" on-change="ctrl.setEndDate()"></soe-textbox>
                </div>
                <div class="col-sm-3">
                    <soe-datepicker label-key="economy.accounting.accountdistribution.startdate" model="ctrl.startDate"></soe-datepicker>
                </div>
            </div>
        </div>

        <uib-accordion close-others="false" ng-if="ctrl.newDistribution">
            <soe-accordion label-key="common.accountingrows" is-open="true">
                <div class="form-group form-group-sm">
                    <div class="row">
                        <div class="col-sm-12">                            
                            <distribution-rows accounting-rows="ctrl.accountingRows" show-amount-summary="true" difference="ctrl.accountingRowsDifference"></distribution-rows>
                        </div>
                    </div>
                </div>
            </soe-accordion>
        </uib-accordion>
    </div>
    <div class="modal-footer">
        <div class="pull-right">
            <div class="col">
                <button type="button" class="btn btn-default" data-ng-click="ctrl.buttonCancelClick()">{{::ctrl.buttonCancelLabel}}</button>
            </div>
            <div class="col">
                <button data-ng-show="ctrl.valid && !ctrl.hasDifference" type="button" class="btn btn-sm ngSoeMainButton" data-ng-click="ctrl.buttonOkClick()" data-l10n-bind data-ng-disabled="!ctrl.valid || ctrl.hasDifference">{{::ctrl.buttonOkLabel}}</button>
                <div class="btn-group" role="group" data-ng-show="!ctrl.valid || ctrl.hasDifference">
                    <button type="button" class="btn btn-sm ngSoeMainButton" data-l10n-bind data-ng-disabled="!ctrl.valid || ctrl.hasDifference">{{::ctrl.buttonOkLabel}}</button>
                    <button type="button"  data-ng-show="!ctrl.buttonOkIsValid() || ctrl.hasDifference" class="btn btn-sm ngSoeMainButtonInvalid  no-left-border-radius" data-l10n-bind data-l10n-bind-title="'error.unabletosave_tooltip'" data-ng-click="$event.stopPropagation();ctrl.showValidationError()">!</button>
                </div>
            </div>
        </div>
    </div>
