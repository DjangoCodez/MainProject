<form name="ctrl.edit" class="ngSoeForm" novalidate autocomplete="off" data-form-state="ctrl.dirtyHandler.isDirty" confirm-on-exit>
    <soe-progressbar is-busy="ctrl.progressBusy" message="ctrl.progressMessage"></soe-progressbar>

    <div data-ng-if="!ctrl.progressBusy">
        <soe-toolbar buttons="ctrl.toolbar.buttonGroups"></soe-toolbar>
        <div class="form-group form-group-sm">
            <div class="row" style="margin-left: 5px; margin-right: 5px;">
                <soe-panel label-key="economy.accounting.companygroup.companygrouptransfer">
                    <div class="row">
                        <div class="col-sm-2">
                            <soe-select label-key="economy.accounting.companygroup.transfertype" model="ctrl.selectedTransferType" items="ctrl.transferTypes" options="item as item.name for item in items" use-ignore-dirty="true"></soe-select>
                        </div>
                        <div class="col-sm-2">
                            <soe-select label-key="economy.accounting.accountyear" model="ctrl.selectedAccountYear" items="ctrl.accountYears" options="item as item.yearFromTo for item in items" use-ignore-dirty="true"></soe-select>
                        </div>
                        <div class="col-sm-2">
                            <soe-select label-key="economy.accounting.companygroup.periodfrom" model="ctrl.selectedPeriodFrom" items="ctrl.accountPeriods" options="item as item.value for item in items" use-ignore-dirty="true" ng-if="!ctrl.showBudgetFields && !ctrl.showBalanceFields"></soe-select>
                            <soe-select label-key="economy.accounting.companygroup.masterbudget" model="ctrl.selectedBudgetMaster" items="ctrl.filteredBudgets" options="item as item.name for item in items" use-ignore-dirty="true" ng-if="ctrl.showBudgetFields"></soe-select>
                        </div>
                        <div class="col-sm-2">
                            <soe-select label-key="economy.accounting.companygroup.periodto" model="ctrl.selectedPeriodTo" items="ctrl.accountPeriods" options="item as item.value for item in items" use-ignore-dirty="true" ng-if="!ctrl.showBudgetFields && !ctrl.showBalanceFields"></soe-select>
                            <soe-select label-key="economy.accounting.companygroup.childcompany" model="ctrl.selectedCompanyFrom" items="ctrl.filteredChildCompanies" options="item.id as item.name for item in items" use-ignore-dirty="true" ng-if="ctrl.showBudgetFields" is-disabled="!ctrl.selectedBudgetMaster"></soe-select>
                        </div>
                        <div class="col-sm-2">
                            <soe-select label-key="economy.accounting.voucherseriestype" model="ctrl.selectedVoucherSerie" items="ctrl.voucherSeries" options="item as item.voucherSeriesTypeName for item in items" use-ignore-dirty="true" ng-if="!ctrl.showBudgetFields && !ctrl.showBalanceFields"></soe-select>
                            <soe-select label-key="economy.accounting.companygroup.childbudget" model="ctrl.selectedBudgetChildCompany" items="ctrl.filteredChildCompanyBudgets" options="item as item.name for item in items" use-ignore-dirty="true" ng-if="ctrl.showBudgetFields" is-disabled="!ctrl.selectedBudgetMaster"></soe-select>
                        </div>
                    </div>
                </soe-panel>
            </div>
            <div class="row margin-large-top" style="margin-left: 5px; margin-right: 5px;">
                <uib-accordion close-others="false">
                    <soe-accordion label-key="economy.accounting.companygroup.completedtransfers" is-open="true">
                        <div class="row">
                            <div class="col-sm-12">
                                <div ag-grid="ctrl.transferGridOptions.gridOptions" class="ag-theme-balham" style="height: 300px; width: 100%;"></div>
                                <div id="totals-grid" class="ag-theme-balham" style="height: 25px; width: 100%;" prevent-enter></div>
                            </div>
                        </div>
                    </soe-accordion>
                    <soe-accordion label-key="economy.accounting.companygroup.log" is-open="ctrl.logExpanderIsOpen">
                        <table class="table table-outer-bordered table-condensed table-striped table-hover">
                            <thead>
                                <tr>
                                    <th scope="col" data-l10n-bind="'common.errormessage'"></th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr data-ng-repeat="text in ctrl.log track by $index">
                                    <td><span><soe-label model="text" discreet="true"></span></td>
                                </tr>
                            </tbody>
                        </table>
                    </soe-accordion>
                </uib-accordion>
            </div>
        </div>
        <div class="ngSoeFormFooter">
            <div class="col-sm-12">
                <div class="pull-right">
                    <div class="btn-group">
                        <div class="col">
                            <button type="button" class="btn btn-sm btn-default" data-l10n-bind="'core.cancel'" data-l10n-bind-title="'core.cancel'" data-ng-click="$event.stopPropagation();ctrl.cancel()"></button>
                        </div>
                        <div class="col">
                            <button type="button" class="btn btn-sm btn-primary" data-l10n-bind="'economy.accounting.companygroup.dotransfer'" data-l10n-bind-title="'economy.accounting.companygroup.dotransfer'" data-ng-click="$event.stopPropagation();ctrl.initTransfer()"></button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</form>