<div>
    <div class="modal-header">
        <button type="button" class="close" data-ng-click="ctrl.cancel()">&times;</button>
        <h6 class="modal-title">
            <span data-l10n-bind="'time.schedule.planning.saveandactivate'"></span>
        </h6>
    </div>
    <div class="modal-body">
        <div class="row">
            <div class="col-sm-2">
                <soe-textbox label-key="common.date" model="ctrl.date | date:'shortDate'" is-readonly="true" input-class="borderless" input-class-condition="true"></soe-textbox>
            </div>
            <div class="col-sm-6">
                <soe-textbox label-key="time.schedule.planning.templateschedule" model="ctrl.template.name" is-readonly="true" input-class="borderless" input-class-condition="true"></soe-textbox>
            </div>
            <div class="col-sm-2">
                <soe-textbox label-key="time.schedule.planning.saveandactivate.placement.startdate" model="ctrl.placement.startDate | date:'shortDate'" is-readonly="true" input-class="borderless" input-class-condition="true"></soe-textbox>
            </div>
            <div class="col-sm-2">
                <soe-textbox label-key="time.schedule.planning.saveandactivate.placement.stopdate" model="ctrl.placement.stopDate | date:'shortDate'" is-readonly="true" input-class="borderless" input-class-condition="true"></soe-textbox>
            </div>
        </div>

        <div class="row margin-large-top" data-ng-if="ctrl.nbrOfShiftsToSave === 0">
            <div class="col-sm-12">
                <div class="warning">
                    <div>
                        <span data-l10n-bind="'time.schedule.planning.saveandactivate.cantactivateemptyday'"></span>
                    </div>
                </div>
            </div>
        </div>

        <div class="row margin-large-top" data-ng-if="ctrl.nbrOfShiftsToSave > 0 && ctrl.template && !ctrl.placement">
            <div class="col-sm-12">
                <div class="warning">
                    <div>
                        <span data-l10n-bind="'time.schedule.planning.saveandactivate.noplacement'"></span>
                    </div>
                </div>
            </div>
        </div>

        <div data-ng-if="ctrl.nbrOfShiftsToSave > 0 && ctrl.template && ctrl.placement">
            <div class="row margin-large-top">
                <div class="col-sm-12">
                    <div class="info">
                        <div>
                            <span data-l10n-bind="'time.schedule.planning.saveandactivate.info.row1'"></span>
                        </div>
                        <div>
                            <span data-l10n-bind="'time.schedule.planning.saveandactivate.info.row2'"></span>
                        </div>
                    </div>
                </div>
            </div>

            <div class="form-inline margin-large-top">
                <div class="form-group form-group-sm">
                    <div class="input-group">
                        <soe-datepicker hidelabel="true" model="ctrl.dateFrom"></soe-datepicker>
                    </div>
                </div>
                <span class="margin-small-right">-</span>
                <div class="form-group form-group-sm">
                    <div class="input-group">
                        <soe-datepicker hidelabel="true" model="ctrl.dateTo"></soe-datepicker>
                    </div>
                </div>
                <div class="form-group form-group-sm margin-large-left">
                    <button type="button" class="btn btn-sm btn-default" data-l10n-bind="'time.schedule.planning.saveandactivate.loadtemplatechanges'" data-ng-disabled="ctrl.disableLoadTemplateChanges" data-ng-click="ctrl.loadTemplateChanges();"></button>
                </div>
                <div class="form-group form-group-sm">
                    <span class="far fa-spinner fa-pulse fa-fw" data-ng-if="ctrl.executing;"></span>
                </div>
            </div>

            <div class="row margin-large-top">
                <div class="col-sm-12">
                    <soe-label label-key="time.schedule.planning.saveandactivate.shiftsafterupdate"></soe-label>
                    <span>{{ctrl.shiftsAfterUpdate}}</span>
                </div>
            </div>

            <div class="row margin-large-top">
                <div class="col-sm-12">
                    <div class="table-outer-bordered">
                        <div class="table-scrollable-wrapper">
                            <div class="table-scrollable" style="height: 331px;">
                                <table class="table table-more-condensed table-hover">
                                    <thead>
                                        <tr>
                                            <th scope="col" style="width: 10px"></th>
                                            <th scope="col" style="width: 20px"><i class="fal link" style="margin-left:0" data-ng-class="{'fa-square': !ctrl.allRowsSelected, 'fa-check-square': ctrl.allRowsSelected}" data-ng-click="ctrl.selectAllRows();"></i></th>
                                            <th scope="col" style="width: 80px"><span data-l10n-bind="'common.date'"></span></th>
                                            <th scope="col" style="width: 100px"><span data-l10n-bind="'common.daytype'"></span></th>
                                            <th scope="col" style="min-width: 100px"><span data-l10n-bind="'time.schedule.planning.saveandactivate.shiftsbeforeupdate'"></span></th>
                                            <th scope="col" style="width: 20px"></th>
                                            <th scope="col" style="width: 20px"></th>
                                            <th scope="col" style="width: 20px"></th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr data-ng-repeat="row in ctrl.rows" data-ng-class="{'table-selected-row': ctrl.selectedRow === row}" data-ng-click="ctrl.selectedRow = row">
                                            <td><i class="fas fa-caret-right" data-ng-if="ctrl.selectedRow === row"></i></td>
                                            <td><i class="fal link" data-ng-class="{'fa-square': !row.selected, 'fa-check-square': row.selected}" data-ng-click="ctrl.rowSelected(row);" data-ng-if="!row.notSelectable"></i></td>
                                            <td><span data-ng-class="{'errorColor': row.notSelectable}">{{row.date | date:'shortDate'}}</span></td>
                                            <td><span data-ng-class="{'errorColor': row.hasInvalidDayType}" data-ng-attr-title="{{row.dayTypeToolTip}}">{{row.dayTypeName}}</span></td>
                                            <td><span data-l10n-bind="'time.schedule.planning.saveandactivate.nodiff'" data-ng-if="!row.hasManualChanges"></span><span data-ng-if="row.hasManualChanges" data-ng-class="{'okColor': row.hasSameChanges, 'warningColor': !row.hasSameChanges}">{{row.shiftsBeforeUpdate}}</span></td>
                                            <td><i class="fal fa-medkit errorColor" data-l10n-bind data-l10n-bind-title="'time.schedule.planning.saveandactivate.hasabsence'" data-ng-if="row.hasAbsence"></i></td>
                                            <td><i class="link fal fa-exclamation-triangle warningColor" data-l10n-bind data-l10n-bind-title="'time.schedule.planning.saveandactivate.haswarnings'" data-ng-if="row.hasWarnings" data-ng-click="ctrl.showWarnings(row);"></i></td>
                                            <td><i class="link fa-user-clock" data-ng-class="{'fas errorColor': row.hasWorkRuleErrors, 'fal warningColor': !row.hasWorkRuleErrors}" data-l10n-bind data-l10n-bind-title="'time.schedule.planning.evaluateworkrules.warning'" data-ng-if="row.hasWorkRuleWarnings || row.hasWorkRuleErrors" data-ng-click="ctrl.showWorkRulesResult(row);"></i></td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="modal-footer">
        <button type="button" class="btn btn-default" data-l10n-bind="'core.cancel'" data-ng-click="ctrl.cancel()"></button>
        <button type="button" class="btn btn-primary" data-l10n-bind="'core.save'" data-ng-disabled="!ctrl.okToSave" data-ng-click="ctrl.save()"></button>
    </div>
</div>
