<div class="messagebox">
    <div class="modal-header">
        <button type="button" class="close" data-ng-click="ctrl.cancel()">&times;</button>
        <h6 class="modal-title" data-l10n-bind="'core.add'" data-ng-if="ctrl.isNew"></h6>
        <h6 class="modal-title" data-l10n-bind="'core.edit'" data-ng-if="!ctrl.isNew"></h6>
    </div>
    <div class="modal-body">
        <div class="row">
            <div class="col-sm-12">
                <div data-ng-class="{'info': ctrl.trans.status != 1, 'warning': ctrl.trans.status == 1}">
                    <span class="indiscreet" data-l10n-bind="'common.status'"></span>: <span data-ng-class="ctrl.trans.statusIcon"></span> <span>{{::ctrl.trans.getStatusName(ctrl.transactionStatuses);}}</span>
                </div>
            </div>
        </div>
        <div class="row margin-small-top">
            <div class="col-sm-2">
                <soe-select label-key="common.type" model="ctrl.trans.type" items="ctrl.transactionTypes" options="item.id as item.name for item in items" required="true" auto-focus="true"></soe-select>
            </div>
            <div class="col-sm-2" data-ng-if="!ctrl.isNew">
                <soe-textbox label-key="common.code" model="ctrl.trans.code" is-readonly="true"></soe-textbox>
            </div>
            <div class="col-sm-4" data-ng-if="ctrl.trans.type == 1 || ctrl.trans.type == 2">
                <soe-select label-key="common.payrollproduct" model="ctrl.trans.payrollProductId" items="ctrl.products" options="item.productId as item.name for item in items" required="true" on-changing="ctrl.setSelectedProduct();"></soe-select>
            </div>
            <div class="col-sm-4" data-ng-if="ctrl.trans.type == 3">
                <soe-select label-key="common.time.timedeviationcause" model="ctrl.trans.timeDeviationCauseId" items="ctrl.causes" options="item.id as item.name for item in items" required="true"></soe-select>
            </div>
            <div class="col-sm-4" data-ng-if="ctrl.trans.type == 4">
                <soe-select label-key="common.timecode" model="ctrl.trans.timeCodeAdditionDeductionId" items="ctrl.timeCodes" options="item.id as item.name for item in items" required="true"></soe-select>
            </div>
        </div>
        <div class="row margin-small-top">
            <div class="col-sm-2">
                <soe-datepicker label-key="common.date" model="ctrl.trans.date"></soe-datepicker>
            </div>
            <div class="col-sm-2">
                <soe-timebox label-key="common.from" model="ctrl.trans.startTime" is-time="true"></soe-timebox>
            </div>
            <div class="col-sm-2">
                <soe-timebox label-key="common.to" model="ctrl.trans.stopTime" is-time="true"></soe-timebox>
            </div>
            <div class="col-sm-2" data-ng-if="ctrl.showTime">
                <soe-textbox label-key="common.length" model="ctrl.trans.quantityFormatted" update-on="blur" input-class="text-right" input-class-condition="true"></soe-textbox>
            </div>
            <div class="col-sm-2" data-ng-if="ctrl.showQuantity">
                <soe-textbox label-key="common.quantity" model="ctrl.trans.quantity" numeric="true"></soe-textbox>
            </div>
            <div class="col-sm-2">
                <soe-textbox label-key="common.amount" model="ctrl.trans.amount" numeric="true" decimals="2"></soe-textbox>
            </div>
        </div>
        <div class="row margin-large-top">
            <div class="col-sm-12">
                <accounting-settings setting-types="ctrl.settingTypes" settings="ctrl.settings" show-base-account="false" set-dim-nr-if-zero="true" min-rows="1" on-initialized="ctrl.setAccounting();"></accounting-settings>
            </div>
        </div>
        <div class="row margin-small-top">
            <div class="col-sm-12">
                <soe-textarea label-key="common.note" model="ctrl.trans.note"></soe-textarea>
            </div>
        </div>
        <div class="row margin-small-top" data-ng-if="ctrl.trans.errorMessage">
            <div class="col-sm-12">
                <soe-textarea label-key="common.errormessage" model="ctrl.trans.errorMessage" is-readonly="true"></soe-textarea>
            </div>
        </div>
        <div class="row margin-small-top" data-ng-if="ctrl.links">
            <div class="col-sm-12">
                <soe-panel label-key="time.time.attest.timeblocks">
                    <table class="table table-outer-bordered table-more-condensed table-hover strikeable">
                        <thead>
                            <tr>
                                <th scope="col"><span data-l10n-bind="'common.payrollproduct'"></span></th>
                                <th scope="col"><span data-l10n-bind="'common.start'"></span></th>
                                <th scope="col"><span data-l10n-bind="'common.end'"></span></th>
                                <th scope="col"><span data-l10n-bind="'common.length'"></span></th>
                                <th scope="col"><span data-l10n-bind="'common.quantity'"></span></th>
                                <th scope="col"<span data-l10n-bind="'time.time.attest.atteststate'"></span></th>
                            </tr>
                        </thead>

                        <tbody>
                            <tr data-ng-repeat="link in ctrl.links" data-ng-class="{'strikeout': link.isDeleted}">
                                <td data-ng-class="{'strikeout': link.isDeleted}"><span>{{link.productNr}}</span> <span>{{link.productName}}</span></td>
                                <td data-ng-class="{'strikeout': link.isDeleted}"><span>{{link.start | date:'shortTime'}}</span></td>
                                <td data-ng-class="{'strikeout': link.isDeleted}"><span>{{link.stop | date:'shortTime'}}</span></td>
                                <td data-ng-class="{'strikeout': link.isDeleted}"><span>{{link.quantity | minutesToTimeSpan}}</span></td>
                                <td data-ng-class="{'strikeout': link.isDeleted}"><span>{{link.quantity}}</span></td>
                                <td data-ng-class="{'strikeout': link.isDeleted}">
                                    <svg height="16px" width="16px" style="margin-bottom: -2px; margin-right: 5px;">
                                        <circle class="shape" cx="8" cy="8" r="8" data-ng-style="{'fill': link.attestStateColor}" data-ng-if="link.attestStateColor"></circle>
                                    </svg>
                                    <span>{{link.attestStateName}}</span>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </soe-panel>
            </div>
        </div>
    </div>
    <div class="modal-footer">
        <button type="button" class="btn btn-default" data-l10n-bind="'time.payroll.payrollimport.employee.transaction.showlinks'" data-ng-if="ctrl.trans.payrollImportEmployeeTransactionId" data-ng-click="ctrl.loadLinks()"></button>
        <button type="button" class="btn btn-default" data-l10n-bind="'core.cancel'" data-ng-click="ctrl.cancel()"></button>
        <button type="button" class="btn btn-primary" data-l10n-bind="'core.save'" data-ng-click="ctrl.save()"></button>
    </div>
</div>