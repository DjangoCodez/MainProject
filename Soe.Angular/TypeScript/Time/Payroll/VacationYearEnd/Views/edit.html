<form name="ctrl.edit" class="ngSoeForm" novalidate autocomplete="off" data-form-state="ctrl.dirtyHandler.isDirty" confirm-on-exit>

    <soe-progressbar is-busy="ctrl.progress.progressBusy" message="ctrl.progress.progressMessage"></soe-progressbar>

    <div>
        <soe-toolbar buttons="ctrl.toolbar.buttonGroups"></soe-toolbar>

        <soe-panel label-key="time.payroll.vacationyearend.create">
            <div class="form-group form-group-sm">
                <div class="form-inline margin-large-bottom">
                    <div class="row">
                        <div class="col-sm-12">
                            <soe-radiobutton label-key="time.employee.vacationgroup.vacationgroups" model="ctrl.contentType" group="contentType" value="0" use-ignore-dirty="true"></soe-radiobutton>
                            <soe-radiobutton label-key="common.employees" model="ctrl.contentType" group="contentType" value="1" use-ignore-dirty="true"></soe-radiobutton>
                        </div>
                    </div>
                </div>

                <!-- Vacation groups -->
                <div class="row" data-ng-if="ctrl.contentType == 0">
                    <div class="col-sm-2">
                        <soe-multiselect label-key="time.employee.vacationgroup.vacationgroups" options="ctrl.vacationGroups" model="ctrl.selectedVacationGroups" on-selection-complete="ctrl.selectionChanged()"></soe-multiselect>
                    </div>
                    <div class="col-sm-2">
                        <soe-datepicker label-key="time.payroll.vacationyearend.date" model="ctrl.date" readonly="true" required="true"></soe-datepicker>
                    </div>
                </div>
                <div class="row margin-small-top" data-ng-if="ctrl.contentType == 0 && ctrl.selectedVacationGroups.length > 0">
                    <div class="col-sm-12">
                        <soe-instruction model="ctrl.selectedVacationGroupNames"></soe-instruction>
                    </div>
                </div>

                <!-- Employees -->
                <div class="row margin-small-bottom" data-ng-if="ctrl.contentType == 1">
                    <div class="col-sm-1">
                        <soe-select label-key="time.payroll.vacationyearend.date" model="ctrl.date" items="ctrl.endDates" options="item.date as item.name for item in items" required="true"></soe-select>
                    </div>
                </div>
                <div class="row" data-ng-if="ctrl.contentType == 1">
                    <div class="col-sm-12">
                        <employees-selection label-key="common.employees" enable-filters="true" from-date="ctrl.fromDate" to-date="ctrl.toDate" user-selection-input="ctrl.userSelectionInput" on-selected="ctrl.onEmployeeSelectionUpdated(employeeSelection)"></employees-selection>
                    </div>
                </div>

                <!-- Test-->
                <div class="row" data-ng-if="ctrl.showTestDate">
                    <div class="col-sm-2">
                        <soe-checkbox label-key="time.payroll.vacationyearend.testotherdate" model="ctrl.useTestDate"></soe-checkbox>
                    </div>
                </div>
                <div class="row">
                    <div class="col-sm-2" data-ng-if="ctrl.useTestDate === true">
                        <soe-datepicker hide-label="true" model="ctrl.testDate"></soe-datepicker>
                    </div>
                </div>
            </div>
        </soe-panel>

        <div class="ngSoeFormFooter">
            <div class="col-sm-12">
                <div class="pull-right">
                    <button type="button" class="btn btn-sm ngSoeMainButton" data-l10n-bind="'core.run'" data-l10n-bind-title="'core.run'" data-ng-if="ctrl.modifyPermission" data-ng-show="ctrl.edit.$valid" data-ng-disabled="!ctrl.edit.$dirty || ctrl.edit.$invalid" data-ng-click="$event.stopPropagation();ctrl.initSave()"></button>
                    <div class="btn-group" role="group" data-ng-if="ctrl.modifyPermission" data-ng-show="ctrl.edit.$invalid">
                        <button type="button" class="btn btn-sm ngSoeMainButton" data-l10n-bind="'core.save'" data-ng-disabled="ctrl.edit.$invalid"></button>
                        <button type="button" class="btn btn-sm ngSoeMainButtonInvalid" data-l10n-bind data-l10n-bind-title="'error.unabletosave_tooltip'" data-ng-click="$event.stopPropagation();ctrl.showValidationError()">!</button>
                    </div>
                </div>
            </div>
        </div>
    </div>
</form>
